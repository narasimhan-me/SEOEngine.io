echo "ğŸ” Running pre-commit checks..."

# Run linting on staged source files only (exclude test files to avoid tsconfig conflicts)
echo "ğŸ“ Running linter on source files..."
cd apps/api
npx -y pnpm@8.15.9 exec eslint "src/**/*.ts" --fix || {
  echo "âŒ Linting failed. Please fix the errors and try again."
  exit 1
}
cd ../..

# Run TypeScript type checks
echo "ğŸ”§ Running TypeScript type checks..."
cd apps/api
npx -y pnpm@8.15.9 exec tsc --noEmit || {
  echo "âŒ TypeScript type check failed. Please fix the errors and try again."
  exit 1
}
cd ../..

# Run unit tests
echo "ğŸ§ª Running unit tests..."
npx -y pnpm@8.15.9 test:unit || {
  echo "âŒ Unit tests failed. Please fix the failing tests and try again."
  exit 1
}

echo "âœ… All pre-commit checks passed!"

